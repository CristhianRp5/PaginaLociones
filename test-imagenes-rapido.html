<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test R√°pido - Im√°genes Panel Admin</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-section h2 {
            color: #2c3e50;
            margin-top: 0;
        }
        .image-test {
            margin: 15px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: #f9f9f9;
        }
        .image-test img {
            max-width: 200px;
            max-height: 200px;
            border: 1px solid #ddd;
            margin: 10px 0;
            display: block;
        }
        .status {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-weight: bold;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
        }
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
        }
        button {
            background: #3498db;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #2980b9;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üñºÔ∏è Test R√°pido - Im√°genes Panel Admin</h1>
        
        <div class="test-section">
            <h2>1. Test de Placeholder</h2>
            <button onclick="testPlaceholder()">üîç Probar Placeholder</button>
            <div id="placeholderResult"></div>
        </div>
        
        <div class="test-section">
            <h2>2. Test de Rutas</h2>
            <button onclick="testPaths()">üîç Probar Rutas</button>
            <div id="pathsResult"></div>
        </div>
        
        <div class="test-section">
            <h2>3. Test de URLs Externas</h2>
            <button onclick="testExternalUrls()">üîç Probar URLs</button>
            <div id="externalResult"></div>
        </div>
        
        <div class="test-section">
            <h2>4. Test de Funci√≥n getImagePath</h2>
            <button onclick="testGetImagePath()">üîç Probar Funci√≥n</button>
            <div id="functionResult"></div>
        </div>
    </div>

    <script>
        // Funci√≥n para generar placeholder como lo hace el panel admin
        function generatePlaceholderDataURL(width = 300, height = 300, text = "Sin imagen") {
            try {
                const canvas = document.createElement('canvas');
                canvas.width = width;
                canvas.height = height;
                const ctx = canvas.getContext('2d');
                
                // Fondo gris claro
                ctx.fillStyle = '#f8f9fa';
                ctx.fillRect(0, 0, width, height);
                
                // Borde
                ctx.strokeStyle = '#dee2e6';
                ctx.lineWidth = 2;
                ctx.strokeRect(1, 1, width - 2, height - 2);
                
                // Texto
                ctx.fillStyle = '#6c757d';
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(text, width / 2, height / 2);
                
                // Icono
                ctx.font = '48px Arial';
                ctx.fillText('üñºÔ∏è', width / 2, height / 2 - 30);
                
                return canvas.toDataURL();
            } catch (error) {
                console.error('Error generando placeholder:', error);
                return 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="300" height="300"><rect width="300" height="300" fill="%23f8f9fa"/><text x="150" y="150" text-anchor="middle" fill="%236c757d">Sin imagen</text></svg>';
            }
        }
        
        // Funci√≥n como la del panel admin
        function getImagePath(product) {
            console.log('üîç getImagePath para producto:', product);
            
            if (product.imagen && product.imagen.trim() !== '') {
                console.log('‚úÖ Usando campo imagen');
                return product.imagen;
            }
            
            if (product.imagen_url && product.imagen_url.trim() !== '') {
                console.log('‚úÖ Usando campo imagen_url');
                return product.imagen_url;
            }
            
            console.log('‚ö†Ô∏è Sin imagen, usando placeholder');
            return '../IMAGENES/placeholder-simple.svg';
        }
        
        // Test de placeholder
        function testPlaceholder() {
            const container = document.getElementById('placeholderResult');
            
            // Test 1: Placeholder din√°mico
            const dynamicPlaceholder = generatePlaceholderDataURL();
            
            // Test 2: Placeholder est√°tico
            const staticPlaceholder = '../IMAGENES/placeholder-simple.svg';
            
            container.innerHTML = `
                <div class="image-test">
                    <h4>Placeholder Din√°mico (Canvas)</h4>
                    <img src="${dynamicPlaceholder}" alt="Placeholder din√°mico" 
                         onload="this.nextSibling.innerHTML='‚úÖ Cargado'" 
                         onerror="this.nextSibling.innerHTML='‚ùå Error'">
                    <div class="status info">Cargando...</div>
                </div>
                
                <div class="image-test">
                    <h4>Placeholder Est√°tico (SVG)</h4>
                    <img src="${staticPlaceholder}" alt="Placeholder est√°tico" 
                         onload="this.nextSibling.innerHTML='‚úÖ Cargado'" 
                         onerror="this.nextSibling.innerHTML='‚ùå Error'">
                    <div class="status info">Cargando...</div>
                </div>
            `;
        }
        
        // Test de rutas
        function testPaths() {
            const container = document.getElementById('pathsResult');
            
            const paths = [
                '../IMAGENES/placeholder-simple.svg',
                './IMAGENES/placeholder-simple.svg',
                '/IMAGENES/placeholder-simple.svg',
                'IMAGENES/placeholder-simple.svg',
                '../IMAGENES/placeholder-hombres.svg'
            ];
            
            let html = '';
            paths.forEach(path => {
                html += `
                    <div class="image-test">
                        <h4>Ruta: ${path}</h4>
                        <img src="${path}" alt="Test ${path}" 
                             onload="this.nextSibling.innerHTML='‚úÖ Cargado'" 
                             onerror="this.nextSibling.innerHTML='‚ùå Error'">
                        <div class="status info">Cargando...</div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        // Test de URLs externas
        function testExternalUrls() {
            const container = document.getElementById('externalResult');
            
            const urls = [
                'https://picsum.photos/200/300',
                'https://via.placeholder.com/200x300',
                'https://placeholder.com/200x300',
                'https://dummyimage.com/200x300/cccccc/969696.png&text=Test'
            ];
            
            let html = '';
            urls.forEach(url => {
                html += `
                    <div class="image-test">
                        <h4>URL: ${url}</h4>
                        <img src="${url}" alt="Test ${url}" 
                             onload="this.nextSibling.innerHTML='‚úÖ Cargado'" 
                             onerror="this.nextSibling.innerHTML='‚ùå Error'">
                        <div class="status info">Cargando...</div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        // Test de funci√≥n getImagePath
        function testGetImagePath() {
            const container = document.getElementById('functionResult');
            
            const testProducts = [
                { id: 1, nombre: 'Test 1', imagen: 'https://picsum.photos/200/300', imagen_url: null },
                { id: 2, nombre: 'Test 2', imagen: null, imagen_url: 'https://via.placeholder.com/200x300' },
                { id: 3, nombre: 'Test 3', imagen: '', imagen_url: '' },
                { id: 4, nombre: 'Test 4', imagen: null, imagen_url: null }
            ];
            
            let html = '';
            testProducts.forEach(product => {
                const imagePath = getImagePath(product);
                html += `
                    <div class="image-test">
                        <h4>Producto: ${product.nombre}</h4>
                        <p><strong>imagen:</strong> ${product.imagen || 'null'}</p>
                        <p><strong>imagen_url:</strong> ${product.imagen_url || 'null'}</p>
                        <p><strong>Resultado:</strong> ${imagePath}</p>
                        <img src="${imagePath}" alt="Test ${product.nombre}" 
                             onload="this.nextSibling.innerHTML='‚úÖ Cargado'" 
                             onerror="this.nextSibling.innerHTML='‚ùå Error'">
                        <div class="status info">Cargando...</div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
    </script>
</body>
</html>
